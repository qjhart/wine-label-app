<link rel="import" href="wine-catalogs-list.html">

<dom-module id="wine-app">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host {
        display: block;
        position: absolute;
        top:0;
        left: 0;
        right:0;
        bottom: 0;
      }
      .paper-tab-links a {
        color: white;
        text-align: center;
        text-decoration: none;
        margin-top: 1em;
      }
      iron-pages {
        position: absolute;
        top:0;
        left: 0;
        right:0;
        bottom: 0;
      }
    </style>

    <app-location route="{{route}}" use-hash-as-path></app-location>
    <!-- <app-location route="{{route}}"></app-location> -->
    <app-route route="{{route}}"
               pattern="/:page"
               data="{{routeData}}"
               tail="{{subroute}}"></app-route>

 

    <paper-header-panel>
      <paper-toolbar>

        <span class="flex">[[label]]</span>

        <div class="flex"></div>

        <paper-menu-button horizontal-align="right" id="menu">
          <paper-icon-button icon="more-vert" class="dropdown-trigger" style="margin:0"></paper-icon-button>

          <paper-menu class="dropdown-content" id="mapLayerMenu" attr-for-selected="page">
            <paper-item page="home">
              <a href="#/home">Home</a>
            </paper-item>
            <paper-item page="labels">
              <a href="#/labels/list">Label This</a>
            </paper-item>
            <paper-item page="catalogs">
              <a href="#/catalogs/list">Price the Vintage</a>
            </paper-item>
            <paper-item page="prices">
              <a href="#/prices">Price Search</a>
            </paper-item>
          </paper-menu>
        </paper-menu-button>

      </paper-toolbar>


      <iron-pages
          style="height: 100%"
          role="main"
          selected="[[page]]"
          fallback-selection="404"
          attr-for-selected="name">
        <wine-login name="login"></wine-login>
        <wine-home name="home"></wine-home>
        <wine-labels api=[[api]] name="labels"
                      route="{{subroute}}"></wine-labels>
        <wine-catalogs api=[[api]] name="catalogs"
                        route="{{subroute}}"></wine-catalogs>
        <wine-prices name="prices"></wine-prices>
        <wine-ttb name="ttb"></wine-ttb>
        <wine-custom name="custom"></wine-custom>
      </iron-pages>
    </paper-header-panel>


  </template>
  <script>
    Polymer({
			is: 'wine-app',
      properties: {
        page: {
          type: String,
          reflectToAttribute: true,
          observer: '_pageChanged'
        },
        label : {
          type : String,
          value : 'UC Davis Wine Apps'
        },
				api: {
					type: "text",
					value: "http://localhost:3000",
//					value: "http://api.labels.qjhart.org",
					reflectToAttribute: true
				},
      },

      headerLabels : {
        home : 'UC Davis Wine Apps',
        labels : 'Label This',
        catalogs : 'Price the Vintage',
        prices : 'Price Search'
      },

      observers: [
        '_routePageChanged(routeData.page)'
      ],

      ready : function() {
//        UCDWineSDK.collections.wines.load();
      },

      _routePageChanged: function(page) {
        this.page = page || 'home';
      },

      _pageChanged: function(page) {
        // Load page import on demand. Show 404 page if fails
        var resolvedPageUrl = this.resolveUrl('wine-' + page + '.html');
        this.importHref(resolvedPageUrl, null, this._showPage404, true);

        this.label = this.headerLabels[page];

        this.$.menu.close();
      },

      _showPage404: function() {
        this.page = '404';
      }
    });
  </script>
</dom-module>
